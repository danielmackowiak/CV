(window.blocksyJsonP=window.blocksyJsonP||[]).push([[12],{30:function(e,t,r){"use strict";r.r(t),r.d(t,"mount",(function(){return l}));var a=r(1),i=r.n(a),n=r(0),o=r.n(n);let c=null;const s={},l=e=>{i.a&&i.a.fn&&i.a.fn.wc_variations_image_update&&(c=i.a.fn.wc_variations_image_update,i.a.fn.wc_variations_image_update=function(t){const r=e.closest(".product").querySelector(".woocommerce-product-gallery");let a="no",i=r.closest(".type-product").id.replace("product-","");i||(i=r.closest('[class*="ct-quick-view"]').querySelector("[data-product_id]").dataset.product_id,i&&(a="yes"));const n=JSON.parse(e.dataset.product_variations),c=!!t.variation_id&&n.find(e=>{let{variation_id:r}=e;return parseInt(r)===parseInt(t.variation_id)}),l=!!r.dataset.currentVariation&&n.find(e=>{let{variation_id:t}=e;return parseInt(t)===parseInt(r.dataset.currentVariation)}),d=r.querySelector(".flexy-items")&&(!l||l&&"default"===l.blocksy_gallery_source&&[...r.querySelector(".flexy-items").children].indexOf(r.querySelector(`.flexy-items [srcset*="${l.image.src}"]`).closest("div"))>0);if(!t.variation_id&&!r.dataset.currentVariation)return;if(parseInt(t.variation_id)===parseInt(r.dataset.currentVariation))return;if(t.variation_id?r.dataset.currentVariation=t.variation_id:r.removeAttribute("data-current-variation"),r.querySelector("[data-flexy]")&&d&&(!c||"default"===c.blocksy_gallery_source)){let e=null,a=0;t&&(e=r.querySelector(`.flexy-items [srcset*="${t.image.src}"]`),e&&(a=[...r.querySelector(".flexy-items").children].indexOf(e.closest("div"))));const i=r.querySelector(".flexy-pills > *").children[a];if((!t||t&&e)&&i)return r.querySelector("[data-flexy]").dataset.flexy.indexOf("no")>-1?(r.querySelector("[data-flexy]").forcedMount&&r.querySelector("[data-flexy]").forcedMount(),void setTimeout(()=>{i.click()},500)):void i.click()}let u=new URL(ct_localizations.ajax_url),f=new URLSearchParams(u.search.slice(1));f.append("action","blocksy_get_product_view_for_variation"),f.append("variation_id",t.variation_id),f.append("product_id",i),f.append("is_quick_view",a),u.search="?"+f.toString(),r.removeAttribute("style"),requestAnimationFrame(()=>{r.dataset.state="loading"}),(e=>s[e]?new Promise(t=>{t(s[e]),s[e]=s[e].clone()}):new Promise(t=>fetch(e).then(r=>{t(r),s[e]=r.clone()})))(u.toString()).then(e=>e.json()).then(e=>{let{success:t,data:a}=e;if(!t)return;const i=document.createElement("div");i.innerHTML=a.html,r.innerHTML=i.firstElementChild.innerHTML,setTimeout(()=>{o.a.trigger("blocksy:frontend:init"),r.removeAttribute("data-state")})})})}}}]);